load "doob.mag";

a,b,c := SolvableDBStatus(32);

for i := 1 to #a do
  s := a[i];
  s := SolvableBelyiMap(s);
  before, after := SolvableLowDegreeModel(s);
  printf "\nSanity checking...\n";
  assert SolvableMapSanityCheck(after);
  assert SolvableLocalSanityCheck(after, 101);
  assert assigned after`SolvableDBLocalSanityCheckTiming;
  assert assigned after`SolvableDBLocalSanityCheckPrime;
  SolvableDBWriteObject(after);
  filename := after`SolvableDBFilename;
  t := SolvableDBAccessEntry(filename);
  printf "\nSanity checking again...\n";
  assert SolvableMapSanityCheck(t);
  assert SolvableLocalSanityCheck(t, 101);
  assert assigned t`SolvableDBBelyiMapTiming;
  assert assigned t`SolvableDBLowDegreeTiming;
  assert assigned t`SolvableDBSanityCheckTiming;
end for;
for i := 1 to #b do
  s := b[i];
  s := SolvableBelyiMap(s);
  before, after := SolvableLowDegreeModel(s);
  printf "\nSanity checking...\n";
  assert SolvableMapSanityCheck(after);
  assert SolvableLocalSanityCheck(after, 101);
  assert assigned after`SolvableDBLocalSanityCheckTiming;
  assert assigned after`SolvableDBLocalSanityCheckPrime;
  SolvableDBWriteObject(after);
  filename := after`SolvableDBFilename;
  t := SolvableDBAccessEntry(filename);
  printf "\nSanity checking again...\n";
  assert SolvableMapSanityCheck(t);
  assert SolvableLocalSanityCheck(t, 101);
  assert assigned t`SolvableDBBelyiMapTiming;
  assert assigned t`SolvableDBLowDegreeTiming;
  assert assigned t`SolvableDBSanityCheckTiming;
end for;
